# Messed by FabioLolix :/ loli_fabio@protonmail.com
# https://github.com/FabioLolix
#
# Maintainer: Ali Ukani <ali.ukani@gmail.com>

pkgname=voltra
pkgver=2.0
pkgrel=1
pkgdesc='Voltra music player. Organize your own music, discover and buy new music'
arch=('i386' 'x86_64')
url='https://voltra.co'
license=('custom')
depends=()
makedepends=()
provides=('voltra')
conflicts=('voltra')
install=${pkgname}.install

source=(https://github.com/FabioLolix/PKGBUILD/blob/master/voltra/voltra.desktop)
source_i686=('https://s3.amazonaws.com/download.voltra.co/voltra32.tar.gz')
source_x86_64=('https://s3.amazonaws.com/download.voltra.co/voltra64.tar.gz')

md5sums=('b78149080a5591421561dd713cab6e8b')
md5sums_i686=('922061ae3b51f53c1d94d52674111339') 
md5sums_x86_64=('5ec489e08e730eabe004a34a89a35c90')

#pkgver() {
#  bsdtar -xf "${srcdir}/control.tar.gz"
#  grep -i "version" "${srcdir}/control" | cut -d ':' -f 2 | sed -e "s/-/_/" -e "s/\s//g"
#}

package() {

    mkdir -p "${pkgdir}"/usr/bin/
    mkdir -p "${pkgdir}"/usr/share/voltra/
    mkdir -p "${pkgdir}"/usr/share/voltra/license/
    mkdir -p "${pkgdir}"/usr/share/applications/
    mkdir -p "${pkgdir}"/usr/share/pixmaps/

    rm ${srcdir}/version

    cp -av "${srcdir}/resources/app/static/icon.png" "${pkgdir}"/usr/share/pixmaps/voltra.png

    install -m 755 "${srcdir}/voltra.desktop" "${pkgdir}"/usr/share/applications/

    rsync -av --no-links "$srcdir"/ "$pkgdir"/usr/share/voltra

    ln -s "${pkgdir}"/usr/share/voltra/voltra "${pkgdir}/usr/bin/voltra"

    mv "${pkgdir}"/usr/share/voltra/LICENSE "${pkgdir}"/usr/share/voltra/license/
    mv "${pkgdir}"/usr/share/voltra/LICENSES.chromium.html "${pkgdir}"/usr/share/voltra/license/


}
