# Messed by FabioLolix :/ loli_fabio@protonmail.com
# https://github.com/FabioLolix
#
# Maintainer: Ali Ukani <ali.ukani@gmail.com>

pkgname=voltra
pkgver=2.3.2
pkgrel=1
pkgdesc='Voltra music player. Organize your own music, discover and buy new music'
arch=('i386' 'x86_64')
url='https://voltra.co'
license=('custom')
provides=('voltra')
conflicts=('voltra')
install=${pkgname}.install

source=('https://github.com/FabioLolix/PKGBUILD/blob/master/voltra/voltra.desktop'
        'https://s3.amazonaws.com/download.voltra.co/Voltra.tar.gz')

md5sums=('b78149080a5591421561dd713cab6e8b'
         'a639c1c28b3f2d4568acf84c4ad7b7e8')

#pkgver() {
#  bsdtar -xf "${srcdir}/control.tar.gz"
#  grep -i "version" "${srcdir}/control" | cut -d ':' -f 2 | sed -e "s/-/_/" -e "s/\s//g"
#}

package() {

    mkdir -p "${pkgdir}"/usr/bin/
    mkdir -p "${pkgdir}"/usr/share/voltra/
    mkdir -p "${pkgdir}"/usr/share/voltra/license/
    mkdir -p "${pkgdir}"/usr/share/applications/
    mkdir -p "${pkgdir}"/usr/share/pixmaps/

    cp -av "${srcdir}/resources/app/static/icon.png" "${pkgdir}"/usr/share/pixmaps/voltra.png

    install -m 755 "${srcdir}/voltra.desktop" "${pkgdir}"/usr/share/applications/

    rsync -av --no-links "$srcdir"/ "$pkgdir"/usr/share/voltra

    ln -s /usr/share/voltra/voltra "${pkgdir}/usr/bin/voltra"

    mv "${pkgdir}"/usr/share/voltra/LICENSE "${pkgdir}"/usr/share/voltra/license/
    mv "${pkgdir}"/usr/share/voltra/LICENSES.chromium.html "${pkgdir}"/usr/share/voltra/license/


}
